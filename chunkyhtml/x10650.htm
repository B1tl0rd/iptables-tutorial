<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>ULOG target</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="Iptables Tutorial 1.2.2"
HREF="book1.htm"><LINK
REL="UP"
TITLE="Iptables targets and jumps"
HREF="c8815.htm"><LINK
REL="PREVIOUS"
TITLE="TTL target"
HREF="x10539.htm"><LINK
REL="NEXT"
TITLE="What's next?"
HREF="x10754.htm"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="table.css"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Iptables Tutorial 1.2.2</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x10539.htm"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 11. Iptables targets and jumps</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x10754.htm"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="ULOGTARGET"
>ULOG target</A
></H1
><P
>    The ULOG target is used to provide user-space logging of
matching packets. If a packet is matched and the ULOG
target is set, the packet information is multicasted together with the whole
packet through a netlink socket. One or more user-space processes may then
subscribe to various multicast groups and receive the packet. This is in other
words a more complete and more sophisticated logging facility that is only
used by iptables and Netfilter so far, and it contains much better facilities
for logging packets. This target enables us to log information to
MySQL databases, and other databases, making it much
simpler to search for specific packets, and to group log entries. You can find
the ULOGD user-land applications at the <A
HREF="a13413.htm#ULOGDSITE"
><I
>ULOGD project page</I
></A
>.
    </P
><DIV
CLASS="TABLE"
><A
NAME="TABLE.ULOGTARGET"
></A
><P
><B
>Table 11-21. ULOG target options</B
></P
><TABLE
BORDER="1"
FRAME="border"
RULES="all"
CLASS="CALSTABLE"
><COL
WIDTH="77"><COL
WIDTH="1*"><TBODY
><TR
><TD
>Option</TD
><TD
>--ulog-nlgroup</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -A INPUT -p TCP --dport 22 -j
ULOG --ulog-nlgroup 2</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>The --ulog-nlgroup option tells the ULOG
target which netlink group to send the packet to. There are 32 netlink groups,
which are simply specified as 1-32. If we would like to reach netlink group 5,
we would simply write --ulog-nlgroup 5. The default netlink
group used is 1.
        </TD
></TR
><TR
><TD
>Option</TD
><TD
>--ulog-prefix</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -A INPUT -p TCP --dport 22 -j ULOG
--ulog-prefix "SSH connection attempt: "</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>The --ulog-prefix option works just the same as the prefix
value for the standard LOG target. This option prefixes all
log entries with a user-specified log prefix. It can be 32 characters long,
and is definitely most useful to distinguish different log-messages and where
they came from.
        </TD
></TR
><TR
><TD
>Option</TD
><TD
>--ulog-cprange</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -A INPUT -p TCP --dport 22 -j ULOG
--ulog-cprange 100</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>The --ulog-cprange option tells the
ULOG target how many bytes of the packet to send to the
user-space daemon of ULOG. If we specify 100 as above, we
would copy 100 bytes of the whole packet to user-space, which would include
the whole header hopefully, plus some leading data within the actual packet.
If we specify 0, the whole packet will be copied to user-space, regardless of
the packets size. The default value is 0, so the whole packet will be copied
to user-space.
        </TD
></TR
><TR
><TD
>Option</TD
><TD
>--ulog-qthreshold</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -A INPUT -p TCP --dport 22 -j ULOG
--ulog-qthreshold 10</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>The --ulog-qthreshold option tells the
ULOG target how many packets to queue inside the kernel
before actually sending the data to user-space. For example, if we set the
threshold to 10 as above, the kernel would first accumulate 10 packets inside
the kernel, and then transmit it outside to the user-space as one single
netlink multi part message. The default value here is 1 because of backward
compatibility, the user-space daemon did not know how to handle multi-part
messages previously.
        </TD
></TR
></TBODY
></TABLE
></DIV
><DIV
CLASS="NOTE"
><P
></P
><TABLE
CLASS="NOTE"
WIDTH="100%"
BORDER="0"
><TR
><TD
WIDTH="25"
ALIGN="CENTER"
VALIGN="TOP"
><IMG
SRC="images/note.gif"
HSPACE="5"
ALT="Note"></TD
><TD
ALIGN="LEFT"
VALIGN="TOP"
><P
>Works under Linux kernel 2.3, 2.4, 2.5 and 2.6.
      </P
></TD
></TR
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x10539.htm"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.htm"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x10754.htm"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>TTL target</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c8815.htm"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>What's next?</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
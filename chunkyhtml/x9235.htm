<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>CONNSECMARK target</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="Iptables Tutorial 1.2.2"
HREF="book1.htm"><LINK
REL="UP"
TITLE="Iptables targets and jumps"
HREF="c8815.htm"><LINK
REL="PREVIOUS"
TITLE="CONNMARK target"
HREF="x9125.htm"><LINK
REL="NEXT"
TITLE="DNAT target"
HREF="x9305.htm"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="table.css"></HEAD
><BODY
CLASS="SECTION"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Iptables Tutorial 1.2.2</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x9125.htm"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 11. Iptables targets and jumps</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x9305.htm"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECTION"
><H1
CLASS="SECTION"
><A
NAME="CONNSECMARKTARGET"
>CONNSECMARK target</A
></H1
><P
>The CONNSECMARK target sets a SELinux security
context mark to or from a packet mark. For further information on
SELinux, read more at the <A
HREF="a13413.htm#SELINUX"
><I
>Security-Enhanced Linux</I
></A
> homepage. The target is only valid in the
mangle table and is used together with the
SECMARK target, where the SECMARK target
is used to set the original mark, and then the CONNSECMARK
is used to set the mark on the whole connection. 
    </P
><P
>SELinux is beyond the scope of this document, but
basically it is an addition of Mandatory Access
Control to Linux. This is more finegrained than the original
security systems of most Linux and Unix security controls. Each object can
have security attributes, or security context,
connected to it, and these attributes are then matched to eachother before
allowing or denying a specific task to be performed. This target will allow a
security context to be set on a connection. 
    </P
><DIV
CLASS="TABLE"
><A
NAME="TABLE.CONNSECMARKTARGET"
></A
><P
><B
>Table 11-4. CONNSECMARK target options</B
></P
><TABLE
BORDER="1"
FRAME="border"
RULES="all"
CLASS="CALSTABLE"
><COL
WIDTH="77"><COL
WIDTH="1*"><TBODY
><TR
><TD
>Option</TD
><TD
>--save</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -t mangle -A PREROUTING -p tcp --dport 80
	    -j CONNSECMARK --save</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>Save the security context mark from the packet to the
connection if the connection is not marked since before. 
            </TD
></TR
><TR
><TD
>Option</TD
><TD
>--restore</TD
></TR
><TR
><TD
>Example</TD
><TD
>iptables -t mangle -A PREROUTING -p tcp --dport 80
	    -j CONNSECMARK --restore</TD
></TR
><TR
><TD
>Explanation</TD
><TD
>If the packet has no security context mark set on it,
the --restore option will set the security
context mark associated with the connection on the packet. 
            </TD
></TR
></TBODY
></TABLE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x9125.htm"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.htm"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x9305.htm"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>CONNMARK target</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c8815.htm"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>DNAT target</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>